import pandas as pd
import datetime

# データを辞書形式で準備
data = {
    '北海道': [('9月11日', '14:00~17:00', 1)],
    '東北': [('9月10日', '16:00~19:00', 2), ('9月10日', '16:00~19:00', 1), ('9月11日', '15:30~18:30', 2),
             ('9月11日', '15:30~18:30', 1), ('9月12日', '16:30~19:30', 2), ('9月12日', '16:30~19:30', 1),
             ('9月13日', '16:00~19:00', 2), ('9月13日', '16:00~19:00', 1), ('9月18日', '15:30~18:30', 2),
             ('9月18日', '16:00~19:00', 1)],
    '東京': [('6月17日', '15:00~18:00', 2), ('6月17日', '15:00~18:00', 1), ('7月8日', '15:00~18:00', 2),
             ('7月8日', '15:00~18:00', 1), ('7月29日', '16:00~19:00', 2), ('7月29日', '16:00~19:00', 1),
             ('7月30日', '16:30~19:30', 2), ('7月30日', '16:30~19:30', 1), ('7月31日', '11:00~14:00', 2),
             ('7月31日', '11:00~14:00', 1), ('8月5日', '13:30~16:30', 2), ('8月5日', '13:30~16:30', 1),
             ('9月10日', '16:00~19:00', 2), ('9月10日', '16:00~19:00', 1), ('9月11日', '14:30~17:30', 1),
             ('9月11日', '15:30~18:30', 2), ('9月12日', '15:30~18:30', 1), ('9月12日', '16:00~19:00', 2),
             ('9月18日', '16:00~19:00', 1), ('9月18日', '16:00~19:00', 2)],
    '中部': [('7月8日', '16:30~19:30', 2), ('7月8日', '16:30~19:30', 1), ('8月26日', '17:00~20:00', 2),
             ('8月26日', '17:00~20:00', 1), ('9月9日', '16:30~19:30', 2), ('9月10日', '16:00~19:00', 1),
             ('9月10日', '16:00~19:00', 2), ('9月12日', '15:30~18:30', 1), ('9月12日', '15:30~18:30', 2),
             ('9月13日', '16:00~19:00', 1), ('9月13日', '16:00~19:00', 2), ('9月18日', '16:00~19:00', 1),
             ('9月18日', '16:00~19:00', 2), ('9月19日', '15:30~18:30', 1), ('9月19日', '15:30~18:30', 2),
             ('9月20日', '15:30~18:30', 1), ('9月20日', '15:30~18:30', 2)],
    '北陸': [('7月8日', '17:00~20:00', 2), ('7月8日', '17:00~20:00', 1), ('8月26日', '17:00~20:00', 2),
             ('8月26日', '17:00~20:00', 1), ('9月11日', '16:00~19:00', 2), ('9月12日', '15:30~18:30', 1),
             ('9月12日', '15:30~18:30', 2), ('9月13日', '16:00~19:00', 1), ('9月13日', '16:00~19:00', 2),
             ('9月17日', '17:00~20:00', 1), ('9月18日', '14:00~17:00', 2), ('9月18日', '16:00~19:00', 1),
             ('9月19日', '15:30~18:30', 2), ('9月19日', '15:30~18:30', 1), ('9月20日', '15:30~18:30', 2),
             ('9月20日', '15:30~18:30', 1)],
    '関西': [('7月8日', '16:30~19:30', 2), ('7月8日', '16:30~19:30', 1), ('8月23日', '17:00~20:00', 2),
             ('8月26日', '17:00~20:00', 1), ('9月9日', '16:30~19:30', 2), ('9月12日', '15:00~18:00', 1),
             ('9月12日', '16:30~19:30', 2), ('9月13日', '16:30~19:30', 1), ('9月13日', '16:30~19:30', 2),
             ('9月18日', '15:30~18:30', 1), ('9月18日', '15:30~18:30', 2), ('9月19日', '15:30~18:30', 1),
             ('9月19日', '15:30~18:30', 2), ('9月20日', '15:30~18:30', 1), ('9月20日', '15:30~18:30', 2)],
    '中国': [('7月8日', '16:30~19:30', 2), ('7月8日', '16:30~19:30', 1), ('8月26日', '17:00~20:00', 2),
             ('9月9日', '16:30~19:30', 1), ('9月9日', '16:30~19:30', 2), ('9月11日', '15:00~18:00', 1),
             ('9月12日', '16:30~19:30', 2), ('9月12日', '16:30~19:30', 1), ('9月17日', '16:30~19:30', 2),
             ('9月18日', '15:30~18:30', 1), ('9月18日', '16:00~19:00', 2), ('9月19日', '15:30~18:30', 1),
             ('9月19日', '15:30~18:30', 2), ('9月20日', '15:30~18:30', 1), ('9月20日', '15:30~18:30', 2)],
    '四国': [('8月23日', '17:00~20:00', 2), ('8月26日', '17:00~20:00', 1), ('8月26日', '17:00~20:00', 2),
             ('9月9日', '16:30~19:30', 1), ('9月11日', '16:00~19:00', 2), ('9月12日', '15:00~18:00', 1),
             ('9月12日', '16:30~19:30', 2), ('9月13日', '16:30~19:30', 1), ('9月17日', '17:00~20:00', 2),
             ('9月18日', '15:30~18:30', 1), ('9月18日', '16:00~19:00', 2), ('9月19日', '15:30~18:30', 1),
             ('9月19日', '15:30~18:30', 2), ('9月20日', '15:30~18:30', 1), ('9月20日', '15:30~18:30', 2)],
    '九州': [('8月2日', '17:30~20:00', 2), ('8月22日', '17:00~20:00', 1), ('8月23日', '17:00~20:00', 2),
             ('8月26日', '17:00~20:00', 1), ('9月10日', '16:00~19:00', 2), ('9月12日', '15:30~18:30', 1),
             ('9月12日', '15:30~18:30', 2), ('9月13日', '16:30~19:30', 1), ('9月17日', '16:30~19:30', 2),
             ('9月18日', '15:30~18:30', 1), ('9月18日', '16:00~19:00', 2), ('9月19日', '15:30~18:30', 1),
             ('9月19日', '15:30~18:30', 2), ('9月20日', '15:30~18:30', 1), ('9月20日', '15:30~18:30', 2)]
}

# 現在の年を取得
current_year = datetime.datetime.now().year

# 全てのデータを1つのDataFrameに結合
all_data = []
for area, events in data.items():
    df = pd.DataFrame(events, columns=['日付', '時間', 'No'])
    df['日付'] = pd.to_datetime(df['日付'].apply(lambda x: f'{current_year}年{x}'), format='%Y年%m月%d日')
    df['エリア'] = area
    all_data.append(df)

result = pd.concat(all_data, ignore_index=True)

# 日付と時間でソート
result = result.sort_values(['日付', '時間'])

# ピボットテーブルを作成して各エリアの情報を別々の列に分ける
result_pivot = result.pivot_table(
    values='No',
    index=['日付', '時間'],
    columns='エリア',
    aggfunc=lambda x: ' '.join(map(str, x)),
    fill_value=''
)

# インデックスをリセット
result_pivot = result_pivot.reset_index()

# 列の順序を指定
column_order = ['日付', '時間', '北海道', '東北', '東京', '中部', '北陸', '関西', '中国', '四国', '九州']
result_pivot = result_pivot[column_order]

# 結果を表示
print(result_pivot)

# CSVファイルとして保存（オプション）
result_pivot.to_csv('電力需給ひっ迫警報.csv', encoding='utf-8-sig', index=False)